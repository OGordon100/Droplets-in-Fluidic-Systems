% -----------
% SETUP
% -----------
\documentclass{physics_article_B}
\title{Mechanical Vibrations of Droplets in Fluidic Systems}
\mytitle{Mechanical Vibrations of Droplets in Fluidic Systems}
\myname{Dominic Coy \& Oliver Gordon}
\studentid{4227789 \& 4224942}
\date{Due Date: 1 June 2018}
\setlength{\bibsep}{10pt plus 0.3ex}
\begin{document}
	
% ----------------------
% COVERSHEET
% ----------------------
\pagenumbering{roman} 
\setcounter{page}{0}
%\includepdf[scale=1]{Images/Cover.pdf}
%\maketitle

% ----------------------
% ABSTRACT
% ----------------------
\pagenumbering{gobble} 
\begin{abstract}
	\large{Stuff 
}
\end{abstract}
	
% ----------------------
% CONTENTS
% ----------------------
%\vspace{4cm}

\tableofcontents

\pagenumbering{roman} 
\setcounter{page}{1}
\setlength{\parskip}{6pt}  
% ----------------------
% INTRODUCTION
% ----------------------
\newpage
\pagenumbering{arabic} 
\setcounter{page}{1}

\section{Introduction\label{sect:intro}}

Simultaneously measuring the rheological properties of fluids, such as viscosity and surface tension, has, in the past, been accomplished with rheometers or drop volume. However, these methods are not particularly viable when analysing rare or expensive liquids such as blood droplets in forensics. When only a few millilitres of fluid are avaliable, the most promising analysis method is to induce and analyse oscillations in small droplets\textsuperscript{\cite{harrold}}. This method could be applied to a wide range of areas, such as lab-on-a-chip systems for diagnosing blood-based illnesses\textsuperscript{\cite{yager}}. Other applications of this vibrational method and supporting theory include monitoring inkjet printing performance\cite{Martin2008}, simulating the crustal deformation of planets\cite{vukasinovic}, and studying energy relaxation in stars\cite{vukasinovic}.

Early experiments using droplets were based on theoretical models developed by Rayleigh\textsuperscript{\cite{rayleigh}} and Chandrasekhar\textsuperscript{\cite{chandrasekhar2}} who showed that, by using simple equations, vibrational frequencies of droplets were related to the viscosity and surface tension of a free liquid globe (essentially a levitated droplet). Temperton et al. claimed to be the first to present a combined theoretical and experimental study of simple Newtonian fluids (such as water) in 2014\textsuperscript{\cite{temperton}}. This approach was later extended by multiple authors who demonstrated that, provided surface tension is already known, the technique could be used to extract frequency dependent physical properties of viscoelastic droplets (such as blood)\textsuperscript{\cite{egry}}.

% I really don't think that this paragraph should be in the intro at all!!
One of the major difficulties encountered during studies is to quickly compute the radius of droplets. Previous authors typically accomplish this by photographing a perfectly lit droplet, counting the widths of pixels and using trigonometry with the camera focal length. For the case of transparent droplets, automated computer vision is considered extremely difficult. This is in spite of the common requirement of big money industries such as fuel manufacturing to identify and quantify droplets during manufacturing\cite{bubblegeneral}. For one, without perfect, even lighting surrounding the droplet, droplets do not have bright regions of contrast fully around their boundary. In the case of transparent droplets, further difficulties arise due to the centre looking identical to its surrounding. Droplets can also have bright reflections in their middle, further confusing simple algorithms\cite{bubblegeneral}. The inevitable presence of noise in images also adds further complexity. As such, more complex algorithms can take nearly a minute to run, and still only achieve accuracies of approximately 80\%\cite{bubble2} for detecting droplets.

Our experiment aims to build a high-throughput system,  to quickly measure the physical properties of many droplets. One easy way to create a high-throughput system, and the way we create ours in this project, is to analyse droplets suspended in a carrier fluid. This is because the carrier fluid can move the droplet in to place and then remove it without using a destructive technique. In this paper we demonstrate a proof of concept of a high-throughput device capable of creating and transporting multiple droplets in a carrier fluid before oscillating them using an obstruction in the channel and then analysing how a laser is refracted through each oscillating droplet. In this paper we start by discussing the history of the field, before putting forward the theory behind why oscillating a droplet is a successful method of rheology. We then present our methods and techniques before discussing our results and there implications. Finally, we will discuss what we would have done differently in this project and what we believe future research in this area should focus on.

The analysis of the oscillations of small droplets suspended within another fluid using vibrational techniques could, in the future, allow us to find the viscosity of either the droplets or the fluid surrounding them\textsuperscript{\cite{Backholm2017}}. Alternatively, we could find the interfacial tension between the two liquids\textsuperscript{\cite{Backholm2017}}. Using a high-throughput system, properties of a fluid can also be tracked in real time, as demonstrated by Harrold et al. in 2016\cite{harrold}. This could be applied to lab-on-a-chip systems, such as an inexpensive, accurate and reliable diagnostic device\textsuperscript{\cite{yager}} for medical diagnosis in developing countries. There is therefore a significant impetus to, in the future, investigate droplets containing mixed fluids, despite little work done to this end outside of this 2016 paper. 

%It is also known that impurities in single droplets, such as particles or polymers, can affect their rheological and surface properties\textsuperscript{\cite{temperton}}. This influences physical properties of the droplets such as the spreading, wetting and dewetting\textsuperscript{\cite{bergeron}}. This alteration can also affect their performance in various applications including fuel injection\textsuperscript{\cite{vukasinovic}}, inkjet printing and microscale mixing/demixing\textsuperscript{\cite{mugele}}. Research suggests that the viscoelastic vibrational modes of droplets may affect many areas of physics including crustal deformation of planets\textsuperscript{\cite{pollitz}}, dynamical properties of atomic nuclei\textsuperscript{\cite{wong}} and energy relaxation mechanisms in neutron stars\textsuperscript{\cite{bastrukov}}. 

%There are multiple advantages of using vibrational spectra to determine rheological properties when compared to conventional methods such as drop volume and microrheology. For one, only a small amount of fluid on the order of mL\cite{temperton} is required. This makes it viable to investigate expensive and rare materials. This could be applied to lab-on-a-chip systems, allowing chemical reactions to be tracked live. There is therefore a significant impetus to investigate droplets containing mixed fluids, despite little work done to this end outside of this 2016 paper. Other applications of this vibrational method and supporting theory include monitoring inkjet printing performance\cite{Martin2008}, simulating the crustal deformation of planets\cite{vukasinovic}, and studying energy relaxation in stars\cite{vukasinovic}.

%Our experiment aims to build a high-throughput system which could analyse many droplet's physical properties. This system could be extended to perform simultaneous measurements allowing research into how the viscosity and interfacial tension of fluids change during a chemical reaction\textsuperscript{\cite{Backholm2017}}. As this experiment has relevance in microfluidics, future research could investigate lab-on-a-chip based applications\textsuperscript{\cite{Temperton2012}} such as an inexpensive, accurate and reliable diagnostic device\textsuperscript{\cite{yager}} for medical diagnosis in developing countries.

%Harrold et al. also showed that the analysis of vibrational frequencies can be used to track the material properties of droplets over time\textsuperscript{\cite{harrold2}}. Their results agreed with prior work until their droplets became contaminated with airborne particles\textsuperscript{\cite{harrold2}}. However, they showed that this technique could be adapted to study time-dependent, soft matter systems.

%For a vibrating Newtonian liquid, frequencies and spectral widths of oscillation are well known, and these can be used to easily determine its physical properties. However, there is not much data for isolated viscoelastic droplets\textsuperscript{\cite{temperton}}. 

% ----------------------
% Literature Review
% ----------------------

\section{Literature Review\label{sect:lit}}

\subsection{History}

 Building on the work by Rayleigh in 1879, which related the frequency of oscillation of fluidic jets with their area and pressure\textsuperscript{\cite{rayleigh}}, in 1932 Lamb et al. derived an expression for the oscillation frequency of inviscid droplets in an inviscid fluid. They also derived approximate expressions for the rate of damping of oscillations in a viscous droplet in an inviscid fluid and for the oscillations of a bubble of gas in a low viscosity liquid. In their derivations, the velocity fields found for small oscillations of an inviscid fluid were used to estimate the rate of viscous dissipation (rate that shear forces turn work done by a fluid on adjacent layers into heat) in a droplet with small viscosity\textsuperscript{\cite{lamb}}. Then, in 1960, Reid analysed the oscillations of a viscous droplet in a low-density gas or a vacuum\textsuperscript{\cite{reid}}. His experiment and analysis were summarised in the book Hydrodynamics and Hydrodynamic Stability by Chandrasekhar in 1961\textsuperscript{\cite{chandrasekhar}}. In 1965, Velentine et al. used the same methods as Lamb et al. to derive expressions for the damping rate of oscillations when a low viscosity droplet was submerged in a low viscosity fluid\textsuperscript{\cite{velentine}}. In 1968, Miller et al. derived a general dispersion equation for the oscillations of viscous droplets immersed in a viscous fluid, which could also be applied when the interface between the two fluids possessed elastic and viscous properties of its own. They also derived equations for the rate of damping of oscillations and frequency for specific cases including when the interface between the two fluids is free or is inextensible\textsuperscript{\cite{miller}}.

Much of the initial research within this area looks to have been driven by the ambition to study containerless crystallisation of pure liquids in microgravity\textsuperscript{\cite{wilkes}}. However, many recent experiments have analysed levitated droplets using various different methods. Methods that have been used to levitate the droplets include magnetic\textsuperscript{\cite{hill}}, electrostatic\textsuperscript{\cite{mugele}}, acoustic\textsuperscript{\cite{trinh}} and aerodynamic\textsuperscript{\cite{benmore}}. Even though Backholm et al. studied sessile droplets (lying on a surface) within a fluid\textsuperscript{\cite{Backholm2017}}, there seems to have been limited work done on droplets suspended within another liquid. Even though both sessile droplets and pendant droplets (hanging off an object) are easier to produce than levitated droplets they incur additional energy dissipation mechanisms from the proximity of a surface to the droplet. This affects the damping coefficients of the droplets which changes their vibrational spectra  affecting results\textsuperscript{\cite{sharp}}. These mechanisms can be avoided using either superhydrophobic or superamphiphobic surfaces as the droplets take on a spherical shape and can be described with similar equations to levitated droplets. McHale et al. demonstrated the feasibility of this method using vibrating liquid marbles (droplets stabilised by the adsorption of small particles). However, they found that the particles dominated the droplet's physical properties and so the application of this approach is limited\textsuperscript{\cite{mchale}}. Hence, there is a great interest in analysing droplets suspended within another fluid. 

%It has been known for some time that the vibrational spectra of small droplets can be exploited to determine various material properties. Building on the work of Rayleigh in 1879\cite{rayleigh}, Chandrasekhar\cite{chandrasekhar2} and Velentine\cite{velentine} in 1959 and 1965, respectively, developed theoretical models relating the damping coefficients and oscillation frequencies of simple Newtonian liquids (such as water) to their viscosities. Multiple authors confirmed this experimentally in the 1990s\cite{Egry1998,Meier2000}. 

%Although research was initially based around studying the crystallisation of pure liquids in microgravity\cite{wilkes}, later authors such as Temperton expanded upon these simple models to derive other equations linking the vibrational spectra of a droplet to its rheological properties such as viscosity, $\eta$, surface tension, $\gamma$, and frequency dependant storage and loss moduli, $G'$ and $G''$. 

\subsection{Other Droplet Shapes}

Over the years, experiments have focused on a variety of droplet shapes. Two of the three common droplet geometries are sessile (suspended on a surface)\cite{Temperton2012, vukasinovic, Backholm2017} and pendant (teardrop-shaped and suspended off a surface such as a needle)\cite{Temperton2012}. Despite the relative experimental ease of investigating these suspended droplets, damping interactions and droplet shape can be influenced by the suspension surface or the pipette used to transport them\cite{Sharp2011}. This alters the vibrational spectra, producing errors yet to be fully rectified\cite{harrold}. Despite this, many authors limit such experiments to a single surface\cite{Sharp2011}, leading to differing results. %Although McHale et al. demonstrated that the shape of the droplet can be somewhat controlled for by using superhydrophobic and superamphiphobic substances, this is not always practical as the rheological properties of the droplet are affected by these substances.

One of the main advantages of fluidic levitation involves lower mass loss. During an experiment, mass will be lost as the droplet evaporates over time. For fluidic levitation, this has been shown to be 2-4\%, which is significantly lower than for other methods which see over 10\% \cite{harrold2} mass loss. However, to the best of our knowledge no author has modelled this mass loss and taken it into account. Furthermore, the way in which mass is calculated is also very basic; the droplet is weighed before and after an experiment by comparing the mass of a syringe or paper towel both with and without the droplet. These methods do not take into account leftover residue, and in the case of paper towels are destructive. Additionally, this method of levitation requires placing droplets by hand, which is a slow process. There is therefore a significant impetus to develop a high throughput system allowing multiple droplets to be quickly analysed in a hands-off fashion.

%Although a great deal of research has been performed into determining the rheological properties of simple Newtonian liquids, the oscillations of isolated viscoelastic fluids (such as polymer solutions) have not been as thoroughly investigated; Temperton et al. claimed to be the first to present a combined theoretical and experimental study in 2014\cite{temperton}. However, their calculations relied on knowledge of $\gamma$, making a complete analysis yet to be achieved. To the best of our knowledge, viscoelastic droplets are yet to be analysed in this fashion.

As such, we intend to investigate the other common droplet shape of spherical droplets. These are formed by levitating fluid away from a surface using methods such as magnetic\cite{temperton, hill}, electrostatic\cite{mugele, wong}, aerodynamic\cite{benmore}, acoustic\cite{Temperton2012, Yarin1998}, and fluidic levitation. Fluidic levitation is achieved by placing a droplet of fluid within a suspension medium of different viscosity. Besides spherical droplets, sessile droplets can also be investigated in this fashion by placing them on a suspension slide, as recently demonstrated by Backholm et al\cite{Backholm2017}. These authors also showed that\cite{Backholm2017} by using fluidic levitation, it is possible to determine both the interfacial tension between the droplet and the surrounding liquid, and the rheological properties of the surrounding liquid. %This last sentence is also in the introduction consider removing

\section{Theory\label{sect:theory}}

Following on from prior work, we will be making the major assumption that our droplets will be perfectly spherical. Below the capillary length of the material $l_{cap}$, surface tension, $\gamma$, dominates over gravitational interactions, $g_{eff}$. This results in the lowest energy configuration of the droplet to be spherical. As such, it is important that any droplet investigated has radius, $R$, lower than its capillary length.. As the capillary length, which can be calculated using Equation \ref{eq:lcap}, may not always be known, it is imperative that droplets are kept as small as possible. However, it is possible to investigate larger spherical droplets by performing the experiment in low gravity; this was done in 1979\cite{holt} on Space Shuttle Columbia and resulted in similar findings to the other experiments discussed here. However, this is obviously impractical for our purposes.

\begin{equation} 
\label{eq:lcap}
l_{cap} = \sqrt{\frac{\gamma }{\rho g_{eff} }} , 
\end{equation}
    
Because the droplet has an equilibrium spherical shape, it will undergo shape oscillations when a small perturbation is applied\cite{oscillate}. If this perturbation is in the form of an impulse, the surface of the droplet vibrates at its resonant frequency. This occurs as an impulse drives the surface of the droplet at all frequencies (owing to the mathematics of Fourier transforming a delta function). Vibrations not equal to the resonant frequency are damped, leaving only the vibrations at the resonant frequency of the droplet with a non-zero amplitude. For optimal results, it has been shown that any applied impulse must be long enough to give sufficient time to perturb the drop, but short enough to still be an impulse and not drive the droplet at a particular frequency\cite{temperton}. Furthermore, the amplitude of oscillations must be kept to under 0.1$R$, following work from Becker et al. who found that above this limit oscillations become non-linear, causing the simple equations used here to fail\cite{becker}.
    
These oscillations can be readily observed by placing a water droplet on a hydrophobic plate and gently blowing on it. A laser and photo-diode (discussed further in Section X) can be used to detect this, giving a time dependant signal such as the one shown in Figure X. The frequencies that remain correspond to different modes, $n$, of oscillation. The $n=1$ node corresponds to oscillations of the droplet's centre of mass\textsuperscript{\cite{miller}}, whilst the $n\geq2$ nodes correspond to the surface oscillations which are of interest here. The corresponding frequency, $f_n$, and full-width-half-maxima, $\Delta f_n$, can then be calculated by fourier transforming the oscillatory signal. An example signal is shown in Figure Y. 
    
From here, it is possible to calculate the surface tension, $\gamma$, and viscosity, $\eta$, of the fluid using the equations
 
    \begin{equation} 
    \label{eq:SurfaceTension}
    \gamma = \frac{4\rho R^{2}}{\pi n^{2}}(\Delta f^{2} + f^{2}),
    \end{equation}
    
    \begin{equation} 
    \label{eq:Viscosity}
    \eta = \frac{\pi \rho \Delta f R^{2}}{n^{2}},
    \end{equation}

where $\rho$ is the density of the droplet. To determine $R$, checkerboards of known dimensions can be used to map the pixels on a screen to real world space. Because cameras have no depth-perception, this requires the assumption that the object of interest is in the same plane as the checkerboard. Once the height and width of a spherical droplet, $R_x$ and $R_y$ respectively, has been found in an image containing a checkerboard, $R$ can be calculated with simple trigonometry:
            
            \begin{equation}\label{eq:radii}
                r = \sqrt{\Big(\frac{R_x}{2}\Big)^2 + \Big(\frac{R_y}{2}\Big)^2} .
            \end{equation}
    
However, Equations \ref{eq:SurfaceTension} and \ref{eq:Viscosity} are only valid for simple Newtonian droplets such as water and glycerol. For viscoelastic droplets such as amorphous polymers, biopolymers, metals at very high temperatures or bitumen materials, there has yet to be a complete analysis of droplets without prior knowledge of $\gamma$.
% ----------------------
% Equipment
% ----------------------
\section{Methods\label{sect:method}}

    \subsection{Slide \& Fluid Loop\label{sect:method:slide}}
    
        To interrogate liquids of interest, a clean test environment had to be created. This was accomplished by first creating a plastic mould with a 2 mm diameter tunnel inside. This tunnel size was large enough to allow...  The mould was then filled with PDMS, placed on a glass slide and cured. A 1 mm port was also created on the top side of the slide, and subsequently used to inject fluids of interest. This smaller diameter was chosen as the higher pressure it created prevented backflow/droplets constantly flowing when only a single droplet was ever desired in the slide at any one time.
        
        Three capillary tubes were then attached these ports, before sealing all leaks with flowable silicon. This setup is demonstrated in Figure \ref{fig:control}. Because of the difficulties and long drying times involved with manufacturing perfectly sealed PDMS slides with smooth tunnels, we later changed to perspex instead of glass/PDMS, and carefully drilling the appropriate holes. This had the advantage of being quicker to produce, less fragile, and less prone to internal leaking. 
        
            \begin{figure}[H]
            \centering
            \hspace*{2cm}\includegraphics[scale=0.9]{Figures/Control.eps}
            \captionsetup{justification=centering}
            \caption{Words.} 	
            \label{fig:control}
            \end{figure} 
    
        To move droplets through the slide, the capillary tubes were then connected to a fluid loop consisting of 3 mm (?) tubes. To transport the spherical droplets, mineral oil of a lower viscosity was used as a carrier medium. A microfluidics motor was used to transport the oil from a central reservoir and around the loop. To reduce stress on the capillary tubes of the slide, the motor was attached on the "in" side, so oil is not being pulled against the external tubes, potentially breaking them (?). A t-junction was also placed at the return side of the loop to allow for easy bleeding of air. After being interrogated in the slide, droplets were transported to the reservoir. Here, they could be easily removed by hand, as the droplets were of different density to the mineral oil, so would either sink or float. To prevent these droplets from returning into the flow system, the return and collection tubes were placed at different heights on opposite sides of the reservoir. This setup is demonstrated in Figure \ref{fig:basic}.
        
            \begin{figure}[H]
            \centering
            \hspace*{2.0cm}\includegraphics[scale=0.8]{Figures/Fluid.eps}
            \captionsetup{justification=centering}
            \caption{Words.} 	
            \label{fig:basic}
            \end{figure} 

    \subsection{Motor \& Syringe Pump\label{sect:method:motor}}

        To allow the speed of the fluid to programmatically controlled as part of the computer vision system described below, the motor had to be driven by a DAQ card. However, the card used lacked the circuitry to output sufficient current, making it unable to turn the motor at any voltage. Furthermore, the card had poor output resolution, making very fine control of fluid speed impossible. A current boosting circuit was therefore produced, and is shown in Figure \ref{fig:MotorCircuit}. Besides using an external power supply to increase output current to suitable levels, it maps the 0-4 V input rating of the motor to the full 0-10 V output of the DAQ, effectively increasing its sensitivity. Resistances were chosen both to provide the required output and provide good heat dissipation. Heat dissipation was further improved by attaching a heatsink to the transistor. The 12 $\Omega$ resistor was also replaced with 3 x 36 $\Omega$ resistors to reduce component stress. The motor was given protection by powering the circuit with a current limited power supply set at the maximum current rating of the motor. 
        
            \begin{figure}[H]
                \centering
                \hspace*{-1.8cm}\includegraphics[scale=0.8]{Figures/MotorCircuit.eps}
                \caption{Caption}
                \label{fig:MotorCircuit}
            \end{figure}
        
        To allow droplets of a consistent size of be created, a motorised syringe pump was set up, and code created to automatically interface over a COM port. To decrease the size of droplets being produced, the speed of the motor could be increased. However, droplets needed to be moved as slowly as possible to increase the time of data collection. Droplet size could therefore be made larger by increasing the speed at which the syringe pump was turned by writing code to interface with the pump through a serial port. A large syringe (name?) was chosen.
        
        
    \subsection{Determining Density\label{sect:method:density}}
    
        We employ a different method for determining density than previous others. Typically, $\rho$ is calculated by using $R$ of each spherical droplet to determine its volume, $V$. The mass of the droplet, $m$, is then measured by absorbing a droplet onto a paper towel and comparing to the mass without the droplet\cite{hill}. This method is both destructive and erroneous by up to 10\%\cite{harrold2} due to mass loss during the experiment. It is also not viable for our purposes, as our droplets are suspended in fluid. 
        Instead of measuring density per droplet, we measure density for the fluid in general. By holding our fluid of interest in a syringe, we can compare the mass of an empty and filled syringe. The volume can be easily determined by reading from the scale of the syringe.
    
        This method has multiple advantages. For one, it is non-destructive, making it more practical for many biological investigations such as protein crystallisation  studies\textsuperscript{\cite{zhu}}, cell culture bioreactors\textsuperscript{\cite{konry}}, or any time where an expensive/rare liquid needs to be recovered\cite{Backholm2017}. Further, as the system is self contained and has all measurements taken within seconds, no mass is lost to evaporation. Further, averaging down from larger volumes results in a lower percentage error per droplet, improving the accuracy of $\rho$.
        
    \subsection{Computer Vision\label{sect:method:vision}}
        
        \subsubsection{Acquiring Data\label{sect:method:vision:acquire}}
            In order to allow droplets to be analysed in real time, a computer vision control system was developed. A Logitech C920 camera was chosen for its high image quality, high resolution, and wide field of view. 
            
            Because droplets are not static, strict requirements are placed on the efficiency of calculations. Furthermore, as MATLAB is an interpreted language and lacks hardware acceleration, webcam acquisition operates at very low framerates, making tracking moving droplets in real time difficult. This was overcome by modifying Hebicam\cite{HebiCam}, which was originally created for streaming CCTV footage, and is a MATLAB wrapper for the more efficient openCV. After adapting this package for use with USB webcams, 1080p video could be acquired at 30 FPS with spare processor overhead to perform calculations, as opposed to 6 FPS with none. Furthermore, data was acquired in grayscale (as opposed to RGB), further increasing capture efficiency and reducing the size of stored data. 
            
    
        \subsubsection{Calibration\label{sect:method:vision:calib}}

            To ensure that droplet size was calculated accurately, we applied checkerboard calibration using checkers of a known size. An algorithm implemented in MATLAB\cite{CameraCalibration} was then used to calculate various extrinsic properties of the camera, such as the optical centre, distortions, and focal lengths in x and y. 
        
            There was an added complication to this process in that the PDMS used to create the experiment area was not perfectly flat. Because the algorithms work on the assumptions that checkerboard is flat and the droplet is in plane with the checkerboard, the pattern was instead printed on a long piece of paper, carefully folded and tensioned to the back of the slide. However, this resulted in a small 1mm disparity in depth between the droplet and the checkerboard, resulting in a small error. Using simple trigonometry to measure the distance to objects, this error was estimated to result in a 0.05 mm underestimation of all values of $R$, and as such was added to all calculated values of $R$. 
            
            Further, a limitation was placed on the maximum size of the checkerboard because the slide was of a finite size. Larger checkers had a lower percentage error from imperfect focusing, but smaller checkers could be placed in greater numbers. To determine the optimum checkerboard size for our purposes, we calibrated the camera with checkers between 1.50 and 5.00 mm in size and attempted to determine the size of circles of radius 0.10 to 1.00 mm, and accounted for the 0.05 mm offset. 
            
            Ultimately, it was found most optimal to use checkers of size 0.20x0.20 mm in a 10x11 grid. 20 calibration images were then taken at different positions in similar positions to those used during our experiment. The positions of the checkerboard in the calibration screenshots as determined by the algorithm are shown in Figure \ref{fig:calib}.
            
                \begin{figure}[H]
                    \centering\includegraphics{Figures/CameraExtrinsics.eps}
                    \caption{Figure }\label{fig:calib}
                \end{figure}
            
        \subsubsection{Determining Droplet Size\label{sect:method:vision:size}}
                
                Because droplets were confined to a small area at any one time, only a small 3 mm long window of the slide was ever observed at one time to improve performance. Because moving droplets would suffer from motion blur, the motor first had to be stopped when a droplet was present within this small window. 
                
                To do this, a background photo of the window was  taken with oil flowing but no droplet present. Every time a frame of video was captured, the window was subtracted from the corresponding background. This allowed differences in pixels to be seen. To increase the contrast of these difference in a non-linear manner, they were multiplied by the arbitrarily selected log(6). When a droplet was present in the window, fully bright regions could be easily seen in the area where the droplet was. Once an arbitrary threshold of bright pixels was reached, the droplet was confirmed as being in the window, and the motor stopped. These steps are demonstrated in Figure \ref{fig:detector}.
            
                    \begin{figure}[H]
                        \centering
                        \begin{subfigure}[b]{0.3\textwidth}
                            \includegraphics[width=\textwidth]{Figures/DropFinder/DropFinder1.eps}
                            \caption{Background}
                            \label{fig:detector:back}
                        \end{subfigure}
                        ~ 
                        \begin{subfigure}[b]{0.3\textwidth}
                            \includegraphics[width=\textwidth]{Figures/DropFinder/DropFinder2.eps}
                            \caption{Foreground}
                            \label{fig:detector:fore}
                        \end{subfigure}
                        ~ 
                        \begin{subfigure}[b]{0.3\textwidth}
                            \includegraphics[width=\textwidth]{Figures/DropFinder/DropFinder3.eps}
                            \caption{Difference}
                            \label{fig:detector:diff}
                        \end{subfigure}
                        \caption{Figure to demonstrate how droplets are detected after being created by a mechanical pump. A region of the webcam is defined, and a background image taken of this region (a). This region is continuously monitored, and every frame the region is looked at (b), with a comparison made. When enough bright pixels are observed (c), a droplet is considered to be present in the system.}\label{fig:detector}
                    \end{figure}
            
            To reduce motion blur further, the system was thoroughly bled of air at all times. This is because air was the least dense medium present, and as it moved to the highest point in the system it pushed the oil and therefore the droplet. 
            
            Although this logical test based on bright pixel number is sensitive to noise, it was chosen over an object finder as calculations had to be performed in under 1/30 of a second, as otherwise the droplet could pass the window and fail to be detected, causing the entire system to fail. This noise means that the carrier fluid must be single coloured and free of impurities. 
            
            After stopping the motor and waiting for it to spin down, a new photo could be taken of the droplet, which was guaranteed to be in the pre-defined window, and its outline calculated. This was achieved with a 5-stage algorithm. First, the image was subtracted from the background as before to remove background shapes. To bring out fine dark detail and reduce bright noise, a top-hat filter was then used to set all pixels with brightnesses below 10 to 0 (i.e. black), and all pixels with brightnesses above 20 to 255 (i.e. white). Of the remaining data, an automatic binarising algorithm was then applied to further bring out fine detail, and make a solid white horseshoe. This horseshoe was then turned into a convex hull and filled in. This shape could then be assumed to be a circle, and detected with a Circular Hough Transform based algorithm\cite{imfindcircles}. Each stage of the algorithm is shown in Figure \ref{fig:size}.
            
                \begin{figure}[H]
                    \centering
                    \begin{subfigure}[b]{0.3\textwidth}
                        \includegraphics[width=\textwidth]{Figures/SizeFinder/SizeFinder1.eps}
                        \caption{Raw Image}
                        \label{fig:size:1}
                    \end{subfigure}
                    ~ 
                    \begin{subfigure}[b]{0.3\textwidth}
                        \includegraphics[width=\textwidth]{Figures/SizeFinder/SizeFinder2.eps}
                        \caption{Background Subtraction}
                        \label{fig:size:2}
                    \end{subfigure}
                    ~ 
                    \begin{subfigure}[b]{0.3\textwidth}
                        \includegraphics[width=\textwidth]{Figures/SizeFinder/SizeFinder3.eps}
                        \caption{Top Hat}
                        \label{fig:size:3}
                    \end{subfigure}
                
                    \begin{subfigure}[b]{0.3\textwidth}
                        \includegraphics[width=\textwidth]{Figures/SizeFinder/SizeFinder4.eps}
                        \caption{Binarise}
                        \label{fig:size:4}
                    \end{subfigure}
                    ~ 
                    \begin{subfigure}[b]{0.3\textwidth}
                        \includegraphics[width=\textwidth]{Figures/SizeFinder/SizeFinder5.eps}
                        \caption{Convex Hull}
                        \label{fig:size:5}
                    \end{subfigure}
                    ~  
                    \begin{subfigure}[b]{0.3\textwidth}
                        \includegraphics[width=\textwidth]{Figures/SizeFinder/SizeFinder6.eps}
                        \caption{Detected Circle}
                        \label{fig:size:6}
                    \end{subfigure}
                    \caption{Figure }\label{fig:size}
                \end{figure}
            
            There are a few drawbacks to this algorithm. For one, it is highly sensitive to noise, meaning that if the oil is cloudy then it will fail. The top-hat filter is also semi-manual, and must be tweaked for different droplet colours/transparencies. It also struggles with droplets with a radius below 0.3 mm. Finally, it also relies on our assumption that the droplets are perfectly spherical, which is not completely true.
            
            The error produced by this algorithm was also considered. As we will discuss later, determination of droplet radius only requires knowledge of the width of a bounding box drawn around the sphere. As such, the diameter of 20 droplets of approximately fixed size was determined both by hand and by algorithm to the nearest pixel. 100\% of the droplets were detected by the algorithm to within 4 pixels in diameter. Given that the diameter of the 2mm thick channel corresponded to approximately 80 pixels, it can be estimated that the boundary of a droplet can be calculated to within 5\% error. 
            
            This error is largely due to the pixel-level precision and small number of pixels taken up by the droplet. As the droplets produced for the experiment were typically 25 pixels in radius, they only took up 2000 of the 2073600 pixels in a 1920 x 1080 image. If the camera had a lower focal length it could be positioned far closer to the droplet, allowing droplets to take up more than 0.1\% of the pixels of the image. A higher resolution camera would also increase the accuracy of boundary detection. 
            
            After correcting this bounding box for fish-eye in the lens, the height and width, With knowledge of the perimeter of the droplet, a bounding box could be placed around each droplet, pixels converted to mm, and Equation \ref{eq:radii} used to determine the droplet radius.
            
            From this point, the motor could be re-engaged, and the photodiode probed.
    
    \subsection{Oscillating Droplets\label{sect:method:oscillating}}
        
        After determining the size of the droplets, their vibrational spectra had to be determined. It was not possible to follow previous authors and induce vibrations with compressed air as the droplets were contained in a closed system. Magnetic coils were also considered, however this would have limited the approach to magnetic materials. Although the 30 Hz camera recording would not give enough data points to calculate the spectra, it was sufficient to observe oscillations. Vibrations were therefore confirmed to present if they they could be observed by eye with the camera. These were later confirmed with a 360 FPS phone camera.
        
        Multiple methods were attempted to induce oscillations. Initially, we considered the use of piezoelectric actuators and asymmetrically weighted vibration motors. As these had to be attached externally to the slide, they therefore made the slide as a whole vibrate and not the droplet contained within. 
        
        From here, we attempted to induce oscillations by changing the speed of the motor using the control circuitry shown in Figure \ref{fig:MotorCircuit}. Although the motor could have been pulsed rapidly, this was akin to driving the droplets at a single frequency, rather than applying an impulse. This was confirmed by the presence of a single peak at the driving frequency. Instead, oscillations were attempted to be induced by applying a sudden change in motor voltage, with the hope of having the sudden change in velocity cause the droplet to stretch horizontally and therefore inducing oscillations. We could not confirm if this was successful, as the applied force would have been too weak. 
        
        Next, a DC electric field was considered. For reasons not thoroughly understood, it has been shown that a short, high voltage DC pulse passed across an unpolarised droplet can cause it to oscillate. A 0-6 kV power supply was therefore introduced. As such, two exposed wires were dug into the PDMS on either side of the fluid channel, and each wire connected to either side of the power supply to set up a simple circuit. To maximise the strength of the electric field, the wires were dug into the PDMS as close to the fluid channel as possible. Because of the high breakdown voltage of PDMS\cite{PDMSBreakdown} of 6 kV mm$^{-1}$, the electric field would be highly localised and directly through the channel. As the droplets moved through the channel and therefore through the field, they would therefore be subject to a DC impulse. This allowed the power supply to be left on at all times, which was necessary as no equipment was available to switch the supply in the oscillation timescales seen in Figure X. To reduce the wires producing stray magnetic fields and causing interference in the photodiode circuit by Lenz Law, all wires were tightly twisted in pairs. The photodiode circuit was also recreated to fit the small size of a grounded metal box. However, the high voltage power supply still produced noise with amplitudes up to 1.6 V. This was much larger than the 0.8 V oscillations that we observed and hence, the noise from the power supply was far too large to be able to consider using the DC electric field as an option.
        
        This noise is shown in Figure X. It can be seen from this graph that the field is directly responsible for the noise as when we turn off the electric field it can be seen that there is a large decrease in the noise in the photodiode spectrum.
        
        Finally, a wire obstruction was pushed into the slide. This is shown in Figure \ref{fig:control}. This method relies on water having a high surface tension of Y. Water based droplets, amongst others, would therefore be inclined to cling to a new surface when brought nearby. The mineral oil, with a much lower low surface tension of X, would not. This clinging is demonstrated in Figure X. However, as the droplet moved further away from the obstruction, its equilibrium would once again change to being spherical, and upon "pinging" back to this shape, would begin to oscillate. To increase the strength of the "ping," the droplet was made to cling more strongly to the obstruction by increasing its surface area with sandpaper, and oxidising the surface. Furthermore, a Van-der-Graff generator was also considered to polarise the obstruction, increasing attraction strength further. However, applying a charge when the droplet was nearby caused the droplet to break apart, and because the speed of droplets could never be known precisely, introducing timing circuits for the dissipation of charge would be highly unreliable at best. The height of the obstruction also had to be considered. When the obstruction was deeper into the channel, droplets would be more likely to break up, whilst shallower obstructions would result in oscillations of lower magnitude.  
             
        
    \subsection{Laser \& Photodiode\label{sect:method:laser}}
    
        Because oscillations were expected to occur at frequencies higher than the 30 Hz (i.e. 30 FPS) the webcam could capture at, a photodiode circuit was created to capture oscillations. (Couldn't get camera close enough?) Because droplets could be assumed to have a different refractive index to that of the carrier oil\cite{viscosity1,viscosity2}, it followed that the presence of a droplet would cause laser light to be scattered differently. Furthermore, as the shape of droplets would vary as the oscillated, they would cause light to scatter in proportion to their degree of oscillation. To observe this effect, a laser was set up as shown in Figure \ref{fig:control}, with the laser on one side of the slide and a photodiode on the other. To prevent 50 Hz noise from an AC-DC power supply, the laser was driven by batteries.
        
        Because droplets would be moving as they oscillated, the laser was focused on a wide area of the slide. However, because the laser was brightest about its focal point, the system would be more sensitive around this region than others. To improve the region of sensitivity, the solid angle of this bright region was increased by setting the laser up at a glancing angle of over 45$^{\circ}$ to the slide, instead of face on. For this reason the laser was later replaced with a wider, more powerful He-Ne laser.
        
        To amplify the output of the photodiode, a simple circuit was set up\cite{artofelectronics}. The variable resistor was used to act as a gain control, allowing the output voltage to be made as high as possible within the recording range of the DAQ card. The 200 pF capacitor was not originally included, but was later added to reduce noise. A larger capacitor reduces more noise, but makes the circuit less sensitive to small changes (i.e. oscillations).
    
        \begin{figure}[H]
            \centering
            \includegraphics[scale=0.8]{Figures/PDCircuit.eps}
            \caption{Caption}
            \label{fig:my_label}
        \end{figure}
    

    \subsection{Running Experiments\label{sect:method:exp}}
        
        Ultimately, droplets could be rapidly interrogated through the running of a user-friendly toolbox, which required minimum setup. To set up the code and equipment, files and folders were first created to store raw data. At this point, a previous camera calibration could be selected, or if so desired a new one created with a chooseable number of images. After approving this calibration, operating parameters such as motor voltage and photodiode recording time were then defined. The DAQ card, pump and webcam were then interfaced with so they could be controlled. At this point, the camera was imaged, the checkerboard found, and camera extrinsics calculated. The window of the webcam image in which the droplet was to be imaged was then selected. These steps are shown in Figure \ref{fig:setup:flow}.     
        
        From here, no further user input was required, and experiments could be automatically run. As shown in Figure \ref{fig:setup:logic}, this first began with turning on the motor and running it for a few seconds to clear out any stray material from the slide. The detection window defined earlier was then imaged, and the background image shown in Figure \ref{fig:detector:back} taken. The syringe pump was then turned on for just long enough to produce a single droplet of a consistent size. A video was then taken of the window in real time, and after every frame the foreground was subtracted from the background and compared. Once the threshold conditions described in Section \ref{sect:method:vision:size} were met, the motor was stopped, and the size of the droplet found. The motor was then re-engaged, and the photodiode spectrum recorded. After a pre-defined amount of time, oscillations were detected in this spectrum by looking for significant changes in the signal, and this area fourier transformed. The fourier transform could then be calculated, along with $f$ and $\Delta f$. This data was then saved to disk. Further droplets could then be produced to produce further results.

        \newpage
        \begin{figure}[H]
            \centering
            \hspace*{-5.4cm}\includegraphics[scale=0.8]{Figures/FlowSetup.eps}
            \caption{Caption}
            \label{fig:setup:flow}
        \end{figure}
        
        \newpage
        \begin{figure}[H]
            \centering
            \hspace*{-1cm}\includegraphics[scale=0.8]{Figures/FlowLogic.eps}
            \caption{Caption}
            \label{fig:setup:logic}
        \end{figure}

\section{Error Analysis} 
    
    There were several major sources of error in the experiment.
    
\section{Results \& Discussion}
    
    \subsection{Control Equipment}
    
        The motor agrees with its rated values (cite).
    
		As shown in Figure \ref{fig:calib:error}, the extrinsics of the camera were calculated to a sub-pixel accuracy of 0.41 pixels, indicating a high quality calibration which will produce errors of less than the precision of the droplet finding algorithm discussed later. Across the 20 calibration images, there was a mean error of X, with all images being calibrated to a standard deviation of Y. This indicates...
	        
	    It was found that a 10x11, 0.20mm checkerboard gave the lowest error of 0.03mm. This is shown in Figure \ref{fig:calib:error}. %Also stated in the calibration section, consider removing from here or there
        
            \begin{figure}[H]
                \centering
                \hspace*{-1cm}\includegraphics{Figures/CameraCalib.eps}
                \caption{Caption}
                \label{fig:calib:error}
            \end{figure}
        
     	From here, it can clearly be seen that the algorithm works as intended (more words)

    \subsection{Oscillating Droplets}
      
    (graph of noise amplitude vs power supply?)
 
 	\subsection{Water}
 
    
\section{Future Improvements}

was written to automatically interface with the pump over a COM port. This also has a significant delay, reducing the throughput of droplets.

As we assume that the droplet remains at constant volume, only liquids can be explored as they are incompressible.

As droplets can be made to reliably oscillate using our system, future work should focus around refining methods to observe these oscillations. More powerful, wider laser beam, wide array of photodiodes (or maybe even avalanche to be even more sensitive, provided the laser is stable enough). Better yet, adjustable focus high speed cameras would make everything possible really easily.

% -----------
% REFERENCES
% -----------
\newpage
\bibliographystyle{unsrtnat}
\bibliography{references}

% -----------
% FIN
% -----------
\end{document}    